<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StreetWearX</title>

    <!-- Manifest -->
    <link rel="manifest" href="manifest.json">

    <!-- Estilos bÃ¡sicos -->
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            background: #f5f5f5;
        }

        header {
            background: #000;
            color: #fff;
            padding: 15px;
            text-align: center;
            font-size: 22px;
            font-weight: bold;
        }

        #productsContainer {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 15px;
            padding: 20px;
        }

        .product-card {
            background: white;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }

        .product-card img {
            width: 100%;
            border-radius: 10px;
            height: 180px;
            object-fit: cover;
        }

        .btn {
            background: #111;
            color: #fff;
            padding: 10px;
            text-align: center;
            border-radius: 6px;
            cursor: pointer;
            margin-top: 10px;
        }

        #appStatus {
            text-align: center;
            padding: 10px;
            color: #444;
        }
    </style>

</head>

<body>

<header>StreetWearX</header>

<p id="appStatus">Cargando productos...</p>

<div id="productsContainer"></div>

<!-- Firebase + Cloudinary -->
<script type="module">

/* --------------------------
   ðŸ”¥ IMPORTS FIREBASE
--------------------------- */
import {
    initializeApp
} from "https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js";

import {
    getFirestore, collection, getDocs
} from "https://www.gstatic.com/firebasejs/10.7.0/firebase-firestore.js";

/* --------------------------
   ðŸ”¥ CONFIG FIREBASE
--------------------------- */
const firebaseConfig = {
    apiKey: "TU_API_KEY",
    authDomain: "TU_AUTH_DOMAIN",
    projectId: "TU_PROJECT_ID",
    storageBucket: "TU_STORAGE",
    messagingSenderId: "TU_SENDER_ID",
    appId: "TU_APP_ID"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

/* --------------------------
   ðŸ”¥ CARGAR PRODUCTOS
--------------------------- */
async function loadProducts() {
    try {
        const status = document.getElementById("appStatus");
        status.textContent = "Cargando productos...";

        const querySnapshot = await getDocs(collection(db, "products"));
        const products = [];

        querySnapshot.forEach(doc => {
            products.push({
                id: doc.id,
                ...doc.data()
            });
        });

        displayProducts(products);
        status.textContent = "Productos cargados: " + products.length;
    } catch (error) {
        console.error("Error cargando productos:", error);
        document.getElementById("appStatus").textContent =
            "Error cargando productos";
    }
}

/* --------------------------
   ðŸŽ¨ MOSTRAR PRODUCTOS
--------------------------- */
function displayProducts(products) {
    const container = document.getElementById("productsContainer");
    container.innerHTML = "";

    products.forEach(p => {
        container.innerHTML += `
            <div class="product-card">
                <img src="${p.imageURL}" alt="${p.name}">
                <h3>${p.name}</h3>
                <p>$${p.price}</p>
                <div class="btn" onclick="addToCart('${p.id}')">
                    Agregar al carrito
                </div>
            </div>
        `;
    });
}

/* --------------------------
   ðŸ›’ CARRITO
--------------------------- */
window.addToCart = function(id) {
    alert("Producto agregado: " + id);
};

/* --------------------------
   ðŸ”¥ INICIAR APP
--------------------------- */
loadProducts();

/* --------------------------
   ðŸ“Œ SERVICE WORKER
--------------------------- */
if ("serviceWorker" in navigator) {
    navigator.serviceWorker.register("sw.js")
        .then(() => console.log("SW registrado"))
        .catch(err => console.log("Error SW:", err));
}

</script>

</body>
</html>
